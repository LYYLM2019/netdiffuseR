<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Structure dependence test — struct_test • netdiffuseR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Structure dependence test — struct_test" />
<meta property="og:description" content="Test whether or not a network estimates can be considered structurally dependent, i.e.
a function of the network structure. By rewiring the graph and calculating
a particular statistic \(t\), the test compares the observed mean of \(t\)
against the empirical distribution of it obtained from rewiring the network." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-40608305-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-40608305-5');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">netdiffuseR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.21.999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/analyzing-medical-innovation-data.html">netdiffuseR showcase: Medical Innovations</a>
    </li>
    <li>
      <a href="../articles/introduction-to-netdiffuser.html">Simulating diffusion networks: Using the `rdiffnet` function</a>
    </li>
    <li>
      <a href="../articles/not-lost-in-translation-importing-and-exporting-graphs.html">Not-Lost in translation: Getting diffusion data into netdiffuseR</a>
    </li>
    <li>
      <a href="../articles/time_discount_suscep_infect.html">Time Discounted Infection and Susceptibility</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USCCANA/netdiffuseR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Structure dependence test</h1>
    <small class="dont-index">Source: <a href='https://github.com/USCCANA/netdiffuseR/blob/master/R/struct_test.R'><code>R/struct_test.R</code></a></small>
    <div class="hidden name"><code>struct_test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Test whether or not a network estimates can be considered structurally dependent, i.e.
a function of the network structure. By rewiring the graph and calculating
a particular statistic \(t\), the test compares the observed mean of \(t\)
against the empirical distribution of it obtained from rewiring the network.</p>
    </div>

    <pre class="usage"><span class='fu'>n_rewires</span>(<span class='no'>graph</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>20L</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0.1</span>, <span class='fu'><a href='nvertices.html'>nslices</a></span>(<span class='no'>graph</span>) - <span class='fl'>1</span>)))

<span class='fu'>struct_test</span>(<span class='no'>graph</span>, <span class='no'>statistic</span>, <span class='no'>R</span>, <span class='kw'>rewire.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='no'>...</span>)

<span class='co'># S3 method for diffnet_struct_test</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>...</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># S3 method for diffnet_struct_test</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for diffnet_struct_test</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span>(
  <span class='no'>x</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Empirical Distribution of Statistic"</span>,
  <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='no'>Values</span> ~ <span class='no'>of</span> ~ <span class='no'>t</span>),
  <span class='kw'>breaks</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>annotated</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>b0</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>atop</a></span>(<span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>plain</a></span>(<span class='st'>""</span>) <span class='kw'>%up%</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>plain</a></span>(<span class='st'>""</span>)), <span class='no'>t</span>[<span class='fl'>0</span>]),
  <span class='kw'>b</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>atop</a></span>(<span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>plain</a></span>(<span class='st'>""</span>) <span class='kw'>%up%</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>plain</a></span>(<span class='st'>""</span>)), <span class='no'>t</span>[]),
  <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>
)

<span class='fu'>struct_test_asymp</span>(<span class='no'>graph</span>, <span class='no'>Y</span>, <span class='kw'>statistic_name</span> <span class='kw'>=</span> <span class='st'>"distance"</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>graph</th>
      <td><p>A <code><a href='diffnet-class.html'>diffnet</a></code> graph.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>Either a Numeric scalar or vector of length <code>nslices(graph)-1</code>
with the number of rewires per links.</p></td>
    </tr>
    <tr>
      <th>statistic</th>
      <td><p>A function that returns either a scalar or a vector.</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>Integer scalar. Number of repetitions.</p></td>
    </tr>
    <tr>
      <th>rewire.args</th>
      <td><p>List. Arguments to be passed to <code><a href='rewire_graph.html'>rewire_graph</a></code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to the method (see details).</p></td>
    </tr>
    <tr>
      <th>recursive</th>
      <td><p>Ignored</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A <code>diffnet_struct_test</code> class object.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>Character scalar. Title of the histogram.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>Character scalar. x-axis label.</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>Passed to <code><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></code>.</p></td>
    </tr>
    <tr>
      <th>annotated</th>
      <td><p>Logical scalar. When TRUE marks the observed data average and the simulated data average.</p></td>
    </tr>
    <tr>
      <th>b0</th>
      <td><p>Character scalar. When <code>annotated=TRUE</code>, label for the value of <code>b0</code>.</p></td>
    </tr>
    <tr>
      <th>b</th>
      <td><p>Character scalar. When <code>annotated=TRUE</code>, label for the value of <code>b</code>.</p></td>
    </tr>
    <tr>
      <th>ask</th>
      <td><p>Logical scalar. When <code>TRUE</code>, asks the user to type <code>&lt;Enter&gt;</code> to see each plot (as
many as statistics where computed).</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>Numeric vector of length \(n\).</p></td>
    </tr>
    <tr>
      <th>statistic_name</th>
      <td><p>Character scalar. Name of the metric to compute. Currently
this can be either <code>"distance"</code>,<code>"&gt;"</code>,<code>"&lt;"</code>,<code><a href='https://rdrr.io/r/base/Comparison.html'>"=="</a></code>, <code>"&gt;="</code>,
or <code>"&lt;="</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code>diffnet_struct_test</code> containing the following:</p>
<dt>graph</dt><dd><p>The graph passed to <code>struct_test</code>.</p></dd>
<dt>p.value</dt><dd><p>The resulting p-value of the test (see details).</p></dd>
<dt>t0</dt><dd><p>The observed value of the statistic.</p></dd>
<dt>mean_t</dt><dd><p>The average value of the statistic applied to the simulated networks.</p></dd>
<dt>R</dt><dd><p>Number of simulations.</p></dd>
<dt>statistic</dt><dd><p>The function <code>statistic</code> passed to <code>struct_test</code>.</p></dd>
<dt>boot</dt><dd><p>A <code>boot</code> class object as return from the call to <code>boot</code>.</p></dd>
<dt>rewire.args</dt><dd><p>The list <code>rewire.args</code> passed to <code>struct_test</code>.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>struct_test</code> computes the test by generating the null distribution using
Monte Carlo simulations (rewiring). <code>struct_test_asymp</code> computes the
test using an asymptotic approximation. While available, we do not recommend
using the asymptotic approximation since it has not shown good results when
compared to the MC approximation. Furthermore, the asymptotic version has only
been implemented for <code>graph</code> as static graph.</p>
<p>The output from the <code>hist</code> method is the same as <code><a href='https://rdrr.io/r/graphics/hist.html'>hist.default</a></code>.</p>
<p><code>struct_test</code> is a wrapper for the function <code><a href='https://rdrr.io/pkg/boot/man/boot.html'>boot</a></code> from the
<span class="pkg">boot</span> package. Instead of resampling data--vertices or edges--in each iteration the function
rewires the original graph using <code><a href='rewire_graph.html'>rewire_graph</a></code> and applies
the function defined by the user in <code>statistic</code>.</p>
<p>The default values to <code>rewire_graph</code> via <code>rewire.args</code> are:</p><table class='table'>
<tr><td><code>p</code></td><td>Number or Integer with default <code>n_rewires(graph)</code>.</td></tr>
<tr><td><code>undirected</code></td><td>Logical scalar with default <code><a href='https://rdrr.io/r/base/options.html'>getOption("diffnet.undirected", FALSE)</a></code>.</td></tr>
<tr><td><code>copy.first</code></td><td>Logical scalar with <code>TRUE</code>.</td></tr>
<tr><td><code>algorithm</code></td><td>Character scalar with default <code>"swap"</code>.</td></tr>
</table>


<p>In <code>struct_test</code> <code>...</code> are passed to <code>boot</code>, otherwise are passed
to the corresponding method (<code><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></code> for instance).</p>
<p>From the <code>print</code> method, p-value for the null of the statistic been
equal between graph and its rewired versions is computed as follows</p>

<p>$$%
p(\tau)=2\times\min\left(\mbox{Pr}(t\leq\tau), \mbox{Pr}(t\geq\tau)\right) %
$$</p>
<p>Where \(\mbox{Pr}\{\cdot\}\) is approximated using the
Empirical Distribution Function retrieved from the simulations.</p>
<p>For the case of the asymptotic approximation, under the null we have</p>
<p>$$%
\sqrt{n}\left(\hat\beta(Y,G)-\mu_\beta\right)\sim^d\mbox{N}\left(0,\sigma_\beta^2\right)
$$</p>

<p>The test is actually on development by Vega Yon and Valente. A copy of the
working paper can be distributed upon request to <a href='mailto:g.vegayon@gmail.com'>g.vegayon@gmail.com</a>.</p>
<p>The function <code>n_rewires</code> proposes a vector of number of rewirings that
are performed in each iteration.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Vega Yon, George G. and Valente, Thomas W. (On development).</p>
<p>Davidson, R., &amp; MacKinnon, J. G. (2004). Econometric Theory and Methods. New York:
Oxford University Press.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other Functions for inference: 
<code><a href='bootnet.html'>bootnet</a>()</code>,
<code><a href='moran.html'>moran</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Creating a random graph</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>881</span>)
<span class='no'>diffnet</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rdiffnet.html'>rdiffnet</a></span>(<span class='fl'>100</span>, <span class='fl'>5</span>, <span class='kw'>seed.graph</span><span class='kw'>=</span><span class='st'>"small-world"</span>)

<span class='co'># Testing structure-dependency of threshold</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>struct_test</span>(
  <span class='no'>diffnet</span>,
  <span class='kw'>function</span>(<span class='no'>g</span>) <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='fu'><a href='threshold.html'>threshold</a></span>(<span class='no'>g</span>), <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>),
  <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>100</span>
)

<span class='no'>res</span></div><div class='output co'>#&gt; 
#&gt; Structure dependence test
#&gt; # Simulations     : 100
#&gt; # nodes           : 100
#&gt; # of time periods : 5
#&gt; --------------------------------------------------------------------------------
#&gt;  H0: E[beta(Y,G)|G] - E[beta(Y,G)] = 0 (no structure dependency)
#&gt;     observed    expected       p.val
#&gt;       0.3947      0.1261      0.0000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span>(<span class='no'>res</span>)</div><div class='input'>
<span class='co'># Adding a legend</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>(<span class='st'>"topright"</span>, <span class='kw'>bty</span><span class='kw'>=</span><span class='st'>"n"</span>,
 <span class='kw'>legend</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(
   <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='no'>t</span>[<span class='fl'>0</span>]:~<span class='no'>Baseline</span>),
   <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='no'>t</span>:~<span class='no'>Rewired</span>~<span class='no'>average</span>)
 )
 )</div><div class='img'><img src='struct_test-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Concatenating results</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>res</span>, <span class='no'>res</span>)</div><div class='output co'>#&gt; 
#&gt; Structure dependence test
#&gt; # Simulations     : 200
#&gt; # nodes           : 100
#&gt; # of time periods : 5
#&gt; --------------------------------------------------------------------------------
#&gt;  H0: E[beta(Y,G)|G] - E[beta(Y,G)] = 0 (no structure dependency)
#&gt;     observed    expected       p.val
#&gt;       0.3947      0.1261      0.0000</div><div class='input'>
<span class='co'># Running in parallel fashion</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>struct_test</span>(
  <span class='no'>diffnet</span>, <span class='kw'>function</span>(<span class='no'>g</span>) <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='fu'><a href='threshold.html'>threshold</a></span>(<span class='no'>g</span>), <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>),
  <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>ncpus</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>parallel</span><span class='kw'>=</span><span class='st'>"multicore"</span>
)

<span class='no'>res</span></div><div class='output co'>#&gt; 
#&gt; Structure dependence test
#&gt; # Simulations     : 100
#&gt; # nodes           : 100
#&gt; # of time periods : 5
#&gt; --------------------------------------------------------------------------------
#&gt;  H0: E[beta(Y,G)|G] - E[beta(Y,G)] = 0 (no structure dependency)
#&gt;     observed    expected       p.val
#&gt;       0.3947      0.1213      0.0000</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span>(<span class='no'>res</span>)</div><div class='img'><img src='struct_test-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>George G. Vega Yon</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by George Vega Yon, Thomas Valente.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


